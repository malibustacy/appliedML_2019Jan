---
title: "Model Fitting"
author: "Applied Machine Learning with R<br/><a href='https://therbootcamp.github.io'>www.therbootcamp.com</a><br/><a href='https://twitter.com/therbootcamp'>@therbootcamp</a>"
date: "January 2019"
output:
  xaringan::moon_reader:
    css: ["default", "baselrbootcamp.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
---

layout: true

<div class="my-footer"><span>
<a href="https://therbootcamp.github.io/"><font color="#7E7E7E">Applied Machine Learning with R, January 2019</font></a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="https://therbootcamp.github.io/"><font color="#7E7E7E">www.therbootcamp.com</font></a>
</span></div> 

---


```{r, eval = TRUE, echo = FALSE, warning=F,message=F}
# Code to knit slides
baselers <- readr::read_csv("../_data/baselers.csv")
```


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
# see: https://github.com/yihui/xaringan
# install.packages("xaringan")
# see: 
# https://github.com/yihui/xaringan/wiki
# https://github.com/gnab/remark/wiki/Markdown
options(width=110)
options(digits = 4)
```

```{r, echo = FALSE ,message = FALSE, warning = FALSE}
knitr::opts_chunk$set(comment=NA, fig.width=6, fig.height=6, echo = TRUE, eval = TRUE, 
                      message = FALSE, warning = FALSE, fig.align = 'center', dpi = 200)
library(tidyverse)
library(baselers)
library(ggthemes)
```


.pull-left4[

# Where we are at

- Have a business question
    - How can I predict heart attacks?

- Have data relevant to that question
    - Records from 300 patients

- Data is cleaned and in a dataframe
    - `heartdisease.txt`

## What's next?

<high>Select</high> and <high>train</high> model(s)

]

.pull-right6[
<br><br><br>
```{r, echo = FALSE, fig.align = 'center', out.width = "100%", fig.cap = "Source: Medium.com"}
knitr::include_graphics("https://cdn-images-1.medium.com/max/1600/1*_QGyIwpgq831xI54cIe_GQ.jpeg")
```


]


---


.pull-left6[

# Why do we need a model at all?

]

.pull-right4[

<br>

```{r, echo = FALSE, fig.align = 'center', out.width = "100%"}
knitr::include_graphics("https://github.com/therbootcamp/appliedML_2019Jan/blob/master/_sessions/Fitting/image/data_to_ml.jpg?raw=true")
```

]

---


.pull-left6[

# Why do we need a model at all?


### Theoretical

*To <high>learn something</high> from the data*

- Which features are most <high>important</high>?
- What are the <high>relationship</high> between features and criterion?
- How can I make <high>predictions</high> from new data?

### Practical

- Need a computational representation of the data that can be programmed

]

.pull-right4[

<br>

```{r, echo = FALSE, fig.align = 'center', out.width = "100%"}
knitr::include_graphics("https://github.com/therbootcamp/appliedML_2019Jan/blob/master/_sessions/Fitting/image/data_to_ml.jpg?raw=true")
```

]



---

.pull-left45[

# What types of ML tasks are there?

There are many types of of ML tasks

In this course, you will learn 2 of the most popular

|Model|Description | Example |
|:----|:---- |:----|
|<high>Regression</high> (supervised)|Predicting a number|Stock prices|
|<high>Classification</high> (supervised)|Predicting a category, like whether|Whether someone will purchase a product or not|

]

.pull-right5[
<br><br><br>

```{r, echo = FALSE, fig.align = 'center', out.width = "100%"}
knitr::include_graphics("https://github.com/therbootcamp/appliedML_2019Jan/blob/master/_sessions/Fitting/image/class_v_regression.jpg?raw=true")
```

]

---

.pull-left45[

# What ML models are there?

There are *thousands* of machine learning models

No one could possibly know them all.

In this course, you will learn 3 of the most popular:

|Model|Description |
|:----|:---- |
|Regression|A weighted linear combination of features and weights|
|Decision Tree|A series of heirarchical 'yes/no' decisions|
|Random Forests|Combination of many decision trees|

]

.pull-right5[

```{r, echo = FALSE, fig.align = 'center', out.width = "100%"}
knitr::include_graphics("https://github.com/therbootcamp/appliedML_2019Jan/blob/master/_sessions/Fitting/image/three_models_vert.jpg?raw=true")
```

]

---

.pull-left6[

# Fitting model parameters

Every model has *parameters* that can be *fit* (aka adapt) to data

These parameters *tune* a model to specific data

> "Let me represent the data in the best way I can given how I work"
> ~ Model during fitting
]

.pull-right6[


```{r}
set.seed(100)
x <- rnorm(20)
y <- .7 * x + rnorm(20) + 10

data <- data.frame(x, y)

mod <- lm(y ~ x, data = data)

library(tidyverse)

ggplot(data, aes(x = x, y = y)) + geom_point() +
  geom_abline(slope = 2, intercept = 8, col = "blue", size = 1) +
  geom_abline(slope = .2, intercept = 11, col = "red", size = 1) +
  geom_abline(slope = mod$coefficients[2], intercept = mod$coefficients[1], col = "green", size = 1) +
  labs(title  = "Three different regression lines") +
  theme_minimal()



```





]


---

.pull-left4[

# 3 models

- Regression
- Tree Based
    - Decision Trees
    - Random Forests
- KNN

]

.pull-right6[

]


---

.pull-left4[

# Quantifying performance

Regression - Mean Squared error

]

.pull-right6[


]

---

.pull-left4[

# Quantifying performance

Classification

- Absolute classification error
- Balanced Accuracy
- AUC

]

.pull-right6[

]

---

# How do you know which features were important?

---
# Caret






---


# Practical

<font size=6><b><a href="https://therbootcamp.github.io/Intro2DataScience_2018Oct/_sessions/Plotting/Plotting_practical.html">Link to practical</a>






